"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_webauthn-get-element_webauthn-get-element_ts"],{58700:(e,t,n)=>{n.d(t,{Bt:()=>s,DN:()=>a,KL:()=>c,Se:()=>o,qC:()=>p,sw:()=>u});var r=n(5582);function i(e,t,n){return e.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:n}))}function s(e,t){t&&(function(e,t){if(!(e instanceof HTMLFormElement))throw TypeError("The specified element is not of type HTMLFormElement.");if(!(t instanceof HTMLElement))throw TypeError("The specified element is not of type HTMLElement.");if("submit"!==t.type)throw TypeError("The specified element is not a submit button.");if(!e||e!==t.form)throw Error("The specified element is not owned by the form element.")}(e,t),(0,r.j)(t)),i(e,"submit",!0)&&e.submit()}function o(e,t){if("boolean"==typeof t){if(e instanceof HTMLInputElement)e.checked=t;else throw TypeError("only checkboxes can be set to boolean value")}else{if("checkbox"===e.type)throw TypeError("checkbox can't be set to string value");e.value=t}i(e,"change",!1)}function a(e,t){for(let n in t){let r=t[n],i=e.elements.namedItem(n);i instanceof HTMLInputElement?i.value=r:i instanceof HTMLTextAreaElement&&(i.value=r)}}function u(e){if(!(e instanceof HTMLElement))return!1;let t=e.nodeName.toLowerCase(),n=(e.getAttribute("type")||"").toLowerCase();return"select"===t||"textarea"===t||"input"===t&&"submit"!==n&&"reset"!==n||e.isContentEditable}function l(e){return new URLSearchParams(e)}function c(e,t){let n=new URLSearchParams(e.search),r=l(t);for(let[e,t]of r)n.append(e,t);return n.toString()}function p(e){return l(new FormData(e)).toString()}},5582:(e,t,n)=>{function r(e){let t=e.closest("form");if(!(t instanceof HTMLFormElement))return;let n=i(t);if(e.name){let r=e.matches("input[type=submit]")?"Submit":"",i=e.value||r;n||((n=document.createElement("input")).type="hidden",n.classList.add("js-submit-button-value"),t.prepend(n)),n.name=e.name,n.value=i}else n&&n.remove()}function i(e){let t=e.querySelector("input.js-submit-button-value");return t instanceof HTMLInputElement?t:null}n.d(t,{j:()=>r,u:()=>i})},59840:(e,t,n)=>{n.r(t),n.d(t,{State:()=>i,WebauthnGetElement:()=>l});var r,i,s=n(76006),o=n(8433),a=n(58700);function u(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}!function(e){e.Initializing="initializing",e.Unsupported="unsupported",e.Ready="ready",e.Waiting="waiting",e.Error="error",e.Submitting="submitting"}(i||(i={}));let l=((r=class WebauthnGetElement extends HTMLElement{async connectedCallback(){this.originalButtonText=this.getCurrentButtonText(),this.originalErrorText=this.errorText.textContent,this.setState((0,o.Zh)()?"ready":"unsupported"),this.passkeySupport=await window.PublicKeyCredential?.isUserVerifyingPlatformAuthenticatorAvailable(),"unsupported"!==this.state&&!this.passkeySupport&&this.passkeysUnsupportedMessage&&(this.passkeysUnsupportedMessage.hidden=!1),this.subtleLogin?this.handleWebauthnSubtle():this.showWebauthnLoginFragment()}handleWebauthnSubtle(){let e=document.querySelector(".js-webauthn-subtle");e&&(e.hidden=!1,e.addEventListener("webauthn-subtle-submit",()=>{this.showWebauthnLoginFragment(),"unsupported"!==this.state&&this.prompt()}))}showWebauthnLoginFragment(){let e=document.querySelector(".js-webauthn-login-section");e&&(e.hidden=!1)}getCurrentButtonText(){return this.buttonText.textContent||""}setCurrentButtonText(e){this.buttonText.textContent=e}setState(e){let t=this.button.getAttribute("data-retry-message")||this.originalButtonText,n=this.hasErrored?t:this.originalButtonText;for(let e of(this.setCurrentButtonText(n),this.button.disabled=!1,this.button.hidden=!1,this.errorText.textContent="",this.messages))e.hidden=!0;switch(e){case"initializing":this.button.disabled=!0;break;case"unsupported":this.button.disabled=!0,this.unsupportedMessage.hidden=!1,this.passkeysUnsupportedMessage&&(this.passkeysUnsupportedMessage.hidden=!0);break;case"ready":break;case"waiting":this.waitingMessage.hidden=!1,this.button.hidden=!0;break;case"error":this.errorMessage.hidden=!1,this.errorText.textContent=this.originalErrorText;break;case"submitting":this.setCurrentButtonText("Verifying\u2026"),this.button.disabled=!0;break;default:throw Error("invalid state")}this.state=e}async prompt(e,t){e?.preventDefault(),this.dispatchEvent(new CustomEvent("webauthn-get-prompt"));try{t||this.setState("waiting");let e=JSON.parse(this.dataJson),n=await (0,o.U2)((0,o.wz)(e));this.setState("submitting");let r=this.closest(".js-webauthn-form"),i=r.querySelector(".js-webauthn-response");i.value=JSON.stringify(n),(0,a.Bt)(r)}catch(e){if(!t)throw this.hasErrored=!0,this.setState("error"),e}}constructor(...e){super(...e),this.state="initializing",this.dataJson="",this.subtleLogin=!1,this.hasErrored=!1}}).attrPrefix="",r);u([s.fA],l.prototype,"button",void 0),u([s.fA],l.prototype,"buttonText",void 0),u([s.GO],l.prototype,"messages",void 0),u([s.fA],l.prototype,"capitalizedDescription",void 0),u([s.fA],l.prototype,"unsupportedMessage",void 0),u([s.fA],l.prototype,"passkeysUnsupportedMessage",void 0),u([s.fA],l.prototype,"waitingMessage",void 0),u([s.fA],l.prototype,"errorMessage",void 0),u([s.fA],l.prototype,"errorText",void 0),u([s.Lj],l.prototype,"dataJson",void 0),u([s.Lj],l.prototype,"subtleLogin",void 0),l=u([s.Ih],l)},8433:(e,t,n)=>{function r(e){let t="==".slice(0,(4-e.length%4)%4),n=e.replace(/-/g,"+").replace(/_/g,"/")+t,r=atob(n),i=new ArrayBuffer(r.length),s=new Uint8Array(i);for(let e=0;e<r.length;e++)s[e]=r.charCodeAt(e);return i}function i(e){let t=new Uint8Array(e),n="";for(let e of t)n+=String.fromCharCode(e);let r=btoa(n),i=r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return i}n.d(t,{JO:()=>y,U2:()=>E,Ue:()=>T,Zh:()=>v,wz:()=>w});var s="copy",o="convert";function a(e,t,n){if(t===s)return n;if(t===o)return e(n);if(t instanceof Array)return n.map(n=>a(e,t[0],n));if(t instanceof Object){let r={};for(let[i,s]of Object.entries(t)){if(s.derive){let e=s.derive(n);void 0!==e&&(n[i]=e)}if(!(i in n)){if(s.required)throw Error(`Missing key: ${i}`);continue}if(null==n[i]){r[i]=null;continue}r[i]=a(e,s.schema,n[i])}return r}}function u(e,t){return{required:!0,schema:e,derive:t}}function l(e){return{required:!0,schema:e}}function c(e){return{required:!1,schema:e}}var p={type:l(s),id:l(o),transports:c(s)},d={appid:c(s),appidExclude:c(s),credProps:c(s)},h={appid:c(s),appidExclude:c(s),credProps:c(s)},f={publicKey:l({rp:l(s),user:l({id:l(o),name:l(s),displayName:l(s)}),challenge:l(o),pubKeyCredParams:l(s),timeout:c(s),excludeCredentials:c([p]),authenticatorSelection:c(s),attestation:c(s),extensions:c(d)}),signal:c(s)},b={type:l(s),id:l(s),rawId:l(o),authenticatorAttachment:c(s),response:l({clientDataJSON:l(o),attestationObject:l(o),transports:u(s,e=>{var t;return(null==(t=e.getTransports)?void 0:t.call(e))||[]})}),clientExtensionResults:u(h,e=>e.getClientExtensionResults())},g={mediation:c(s),publicKey:l({challenge:l(o),timeout:c(s),rpId:c(s),allowCredentials:c([p]),userVerification:c(s),extensions:c(d)}),signal:c(s)},m={type:l(s),id:l(s),rawId:l(o),authenticatorAttachment:c(s),response:l({clientDataJSON:l(o),authenticatorData:l(o),signature:l(o),userHandle:l(o)}),clientExtensionResults:u(h,e=>e.getClientExtensionResults())};function y(e){return a(r,f,e)}function w(e){return a(r,g,e)}function v(){return!!(navigator.credentials&&navigator.credentials.create&&navigator.credentials.get&&window.PublicKeyCredential)}async function T(e){let t=await navigator.credentials.create(e);return t.toJSON=()=>a(i,b,t),t}async function E(e){let t=await navigator.credentials.get(e);return t.toJSON=()=>a(i,m,t),t}}}]);
//# sourceMappingURL=ui_packages_webauthn-get-element_webauthn-get-element_ts-0cf5175d8e47.js.map