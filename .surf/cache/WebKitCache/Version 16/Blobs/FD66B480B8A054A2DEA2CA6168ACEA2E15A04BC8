"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["vendors-node_modules_github_text-expander-element_dist_index_js"],{10160:(t,e,i)=>{i.d(e,{Z:()=>Combobox});let Combobox=class Combobox{constructor(t,e,{tabInsertsSuggestions:i,defaultFirstOption:n}={}){this.input=t,this.list=e,this.tabInsertsSuggestions=null==i||i,this.defaultFirstOption=null!=n&&n,this.isComposing=!1,e.id||(e.id=`combobox-${Math.random().toString().slice(2,6)}`),this.ctrlBindings=!!navigator.userAgent.match(/Macintosh/),this.keyboardEventHandler=t=>(function(t,e){if(!t.shiftKey&&!t.metaKey&&!t.altKey&&(e.ctrlBindings||!t.ctrlKey)&&!e.isComposing)switch(t.key){case"Enter":s(e.input,e.list)&&t.preventDefault();break;case"Tab":e.tabInsertsSuggestions&&s(e.input,e.list)&&t.preventDefault();break;case"Escape":e.clearSelection();break;case"ArrowDown":e.navigate(1),t.preventDefault();break;case"ArrowUp":e.navigate(-1),t.preventDefault();break;case"n":e.ctrlBindings&&t.ctrlKey&&(e.navigate(1),t.preventDefault());break;case"p":e.ctrlBindings&&t.ctrlKey&&(e.navigate(-1),t.preventDefault());break;default:if(t.ctrlKey)break;e.clearSelection()}})(t,this),this.compositionEventHandler=t=>(function(t,e){e.isComposing="compositionstart"===t.type;let i=document.getElementById(e.input.getAttribute("aria-controls")||"");i&&e.clearSelection()})(t,this),this.inputHandler=this.clearSelection.bind(this),t.setAttribute("role","combobox"),t.setAttribute("aria-controls",e.id),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-autocomplete","list"),t.setAttribute("aria-haspopup","listbox")}destroy(){this.clearSelection(),this.stop(),this.input.removeAttribute("role"),this.input.removeAttribute("aria-controls"),this.input.removeAttribute("aria-expanded"),this.input.removeAttribute("aria-autocomplete"),this.input.removeAttribute("aria-haspopup")}start(){this.input.setAttribute("aria-expanded","true"),this.input.addEventListener("compositionstart",this.compositionEventHandler),this.input.addEventListener("compositionend",this.compositionEventHandler),this.input.addEventListener("input",this.inputHandler),this.input.addEventListener("keydown",this.keyboardEventHandler),this.list.addEventListener("click",n),this.indicateDefaultOption()}stop(){this.clearSelection(),this.input.setAttribute("aria-expanded","false"),this.input.removeEventListener("compositionstart",this.compositionEventHandler),this.input.removeEventListener("compositionend",this.compositionEventHandler),this.input.removeEventListener("input",this.inputHandler),this.input.removeEventListener("keydown",this.keyboardEventHandler),this.list.removeEventListener("click",n)}indicateDefaultOption(){var t;this.defaultFirstOption&&(null===(t=Array.from(this.list.querySelectorAll('[role="option"]:not([aria-disabled="true"])')).filter(o)[0])||void 0===t||t.setAttribute("data-combobox-option-default","true"))}navigate(t=1){let e=Array.from(this.list.querySelectorAll('[aria-selected="true"]')).filter(o)[0],i=Array.from(this.list.querySelectorAll('[role="option"]')).filter(o),n=i.indexOf(e);if(n===i.length-1&&1===t||0===n&&-1===t){this.clearSelection(),this.input.focus();return}let s=1===t?0:i.length-1;if(e&&n>=0){let e=n+t;e>=0&&e<i.length&&(s=e)}let r=i[s];if(r)for(let t of i){var a;t.removeAttribute("data-combobox-option-default"),r===t?(this.input.setAttribute("aria-activedescendant",r.id),r.setAttribute("aria-selected","true"),!function(t,e){let i=t.scrollTop,n=i+t.clientHeight,s=e.offsetTop,o=s+e.clientHeight;return s>=i&&o<=n}(a=this.list,r)&&(a.scrollTop=r.offsetTop)):t.removeAttribute("aria-selected")}}clearSelection(){for(let t of(this.input.removeAttribute("aria-activedescendant"),this.list.querySelectorAll('[aria-selected="true"]')))t.removeAttribute("aria-selected");this.indicateDefaultOption()}};function n(t){if(!(t.target instanceof Element))return;let e=t.target.closest('[role="option"]');e&&"true"!==e.getAttribute("aria-disabled")&&function(t,e){t.dispatchEvent(new CustomEvent("combobox-commit",{bubbles:!0,detail:e}))}(e,{event:t})}function s(t,e){let i=e.querySelector('[aria-selected="true"], [data-combobox-option-default="true"]');return!!i&&("true"===i.getAttribute("aria-disabled")||(i.click(),!0))}function o(t){return!t.hidden&&!(t instanceof HTMLInputElement&&"hidden"===t.type)&&(t.offsetWidth>0||t.offsetHeight>0)}},57852:(t,e,i)=>{var n=i(10160);let s=/\s|\(|\[/,o=["position:absolute;","overflow:auto;","word-wrap:break-word;","top:0px;","left:-9999px;"],r=["box-sizing","font-family","font-size","font-style","font-variant","font-weight","height","letter-spacing","line-height","max-height","min-height","padding-bottom","padding-left","padding-right","padding-top","border-bottom","border-left","border-right","border-top","text-decoration","text-indent","text-transform","width","word-spacing"],a=new WeakMap,l=new WeakMap;let TextExpander=class TextExpander{constructor(t,e){this.expander=t,this.input=e,this.combobox=null,this.menu=null,this.match=null,this.justPasted=!1,this.lookBackIndex=0,this.oninput=this.onInput.bind(this),this.onpaste=this.onPaste.bind(this),this.onkeydown=this.onKeydown.bind(this),this.oncommit=this.onCommit.bind(this),this.onmousedown=this.onMousedown.bind(this),this.onblur=this.onBlur.bind(this),this.interactingWithList=!1,e.addEventListener("paste",this.onpaste),e.addEventListener("input",this.oninput),e.addEventListener("keydown",this.onkeydown),e.addEventListener("blur",this.onblur)}destroy(){this.input.removeEventListener("paste",this.onpaste),this.input.removeEventListener("input",this.oninput),this.input.removeEventListener("keydown",this.onkeydown),this.input.removeEventListener("blur",this.onblur)}dismissMenu(){this.deactivate()&&(this.lookBackIndex=this.input.selectionEnd||this.lookBackIndex)}activate(t,e){var i,s;if(this.input!==document.activeElement&&this.input!==(null===(s=null===(i=document.activeElement)||void 0===i?void 0:i.shadowRoot)||void 0===s?void 0:s.activeElement))return;this.deactivate(),this.menu=e,e.id||(e.id=`text-expander-${Math.floor(1e5*Math.random()).toString()}`),this.expander.append(e),this.combobox=new n.Z(this.input,e),this.expander.dispatchEvent(new Event("text-expander-activate"));let{top:l,left:u}=function(t,e=t.selectionEnd){let{mirror:i,marker:n}=function(t,e){let i,n;let s=t.nodeName.toLowerCase();if("textarea"!==s&&"input"!==s)throw Error("expected textField to a textarea or input");let l=a.get(t);if(l&&l.parentElement===t.parentElement)l.innerHTML="";else{l=document.createElement("div"),a.set(t,l);let e=window.getComputedStyle(t),i=o.slice(0);"textarea"===s?i.push("white-space:pre-wrap;"):i.push("white-space:nowrap;");for(let t=0,n=r.length;t<n;t++){let n=r[t];i.push(`${n}:${e.getPropertyValue(n)};`)}l.style.cssText=i.join(" ")}let u=document.createElement("span");if(u.style.cssText="position: absolute;",u.innerHTML="&nbsp;","number"==typeof e){let s=t.value.substring(0,e);s&&(i=document.createTextNode(s)),(s=t.value.substring(e))&&(n=document.createTextNode(s))}else{let e=t.value;e&&(i=document.createTextNode(e))}if(i&&l.appendChild(i),l.appendChild(u),n&&l.appendChild(n),!l.parentElement){if(!t.parentElement)throw Error("textField must have a parentElement to mirror");t.parentElement.insertBefore(l,t)}return l.scrollTop=t.scrollTop,l.scrollLeft=t.scrollLeft,{mirror:l,marker:u}}(t,e),s=i.getBoundingClientRect(),l=n.getBoundingClientRect();return setTimeout(()=>{i.remove()},5e3),{top:l.top-s.top,left:l.left-s.left}}(this.input,t.position);if(function(t){try{if(t.matches(":popover-open"))return!0}catch(t){}try{if(t.matches("dialog:modal"))return!0}catch(t){}try{if(t.matches(":fullscreen"))return!0}catch(t){}return!1}(e)){let t=this.input.getBoundingClientRect();l+=t.top,u+=t.left,"absolute"===getComputedStyle(e).position&&(l+=window.scrollY,u+=window.scrollX)}e.style.top=`${l}px`,e.style.left=`${u}px`,this.combobox.start(),e.addEventListener("combobox-commit",this.oncommit),e.addEventListener("mousedown",this.onmousedown),this.combobox.navigate(1)}deactivate(){let t=this.menu;return!!t&&!!this.combobox&&(this.expander.dispatchEvent(new Event("text-expander-deactivate")),this.menu=null,t.removeEventListener("combobox-commit",this.oncommit),t.removeEventListener("mousedown",this.onmousedown),this.combobox.destroy(),this.combobox=null,t.remove(),!0)}onCommit({target:t}){var e;if(!(t instanceof HTMLElement)||!this.combobox)return;let i=this.match;if(!i)return;let n=this.input.value.substring(0,i.position-i.key.length),s=this.input.value.substring(i.position+i.text.length),o={item:t,key:i.key,value:null,continue:!1},r=!this.expander.dispatchEvent(new CustomEvent("text-expander-value",{cancelable:!0,detail:o}));if(r||!o.value)return;let a=null!==(e=this.expander.getAttribute("suffix"))&&void 0!==e?e:" ";o.continue&&(a="");let l=`${o.value}${a}`;this.input.value=n+l+s;let u=n.length+l.length;this.deactivate(),this.input.focus({preventScroll:!0}),this.input.selectionStart=u,this.input.selectionEnd=u,o.continue||(this.lookBackIndex=u,this.match=null),this.expander.dispatchEvent(new CustomEvent("text-expander-committed",{cancelable:!1,detail:{input:this.input}}))}onBlur(){if(this.interactingWithList){this.interactingWithList=!1;return}this.deactivate()}onPaste(){this.justPasted=!0}async onInput(){if(this.justPasted){this.justPasted=!1;return}let t=this.findMatch();if(t){this.match=t;let e=await this.notifyProviders(t);if(!this.match)return;e?this.activate(t,e):this.deactivate()}else this.match=null,this.deactivate()}findMatch(){let t=this.input.selectionEnd||0,e=this.input.value;for(let{key:i,multiWord:n}of(t<=this.lookBackIndex&&(this.lookBackIndex=t-1),this.expander.keys)){let o=function(t,e,i,{multiWord:n,lookBackIndex:o,lastMatchPosition:r}={multiWord:!1,lookBackIndex:0,lastMatchPosition:null}){let a=t.lastIndexOf(e,i-1);if(-1===a||a<o)return;if(n){if(null!=r){if(r===a)return;a=r-e.length}let n=t[a+1];if(" "===n&&i>=a+e.length+1)return;let s=t.lastIndexOf("\n",i-1);if(s>a)return;let o=t.lastIndexOf(".",i-1);if(o>a)return}else{let e=t.lastIndexOf(" ",i-1);if(e>a)return}let l=t[a-1];if(l&&!s.test(l))return;let u=t.substring(a+e.length,i);return{text:u,position:a+e.length}}(e,i,t,{multiWord:n,lookBackIndex:this.lookBackIndex,lastMatchPosition:this.match?this.match.position:null});if(o)return{text:o.text,key:i,position:o.position}}}async notifyProviders(t){let e=[],i=!this.expander.dispatchEvent(new CustomEvent("text-expander-change",{cancelable:!0,detail:{provide:t=>e.push(t),text:t.text,key:t.key}}));if(i)return;let n=await Promise.all(e),s=n.filter(t=>t.matched).map(t=>t.fragment);return s[0]}onMousedown(){this.interactingWithList=!0}onKeydown(t){"Escape"===t.key&&(this.match=null,this.deactivate()&&(this.lookBackIndex=this.input.selectionEnd||this.lookBackIndex,t.stopImmediatePropagation(),t.preventDefault()))}};let TextExpanderElement=class TextExpanderElement extends HTMLElement{get keys(){let t=this.getAttribute("keys"),e=t?t.split(" "):[],i=this.getAttribute("multiword"),n=i?i.split(" "):[],s=0===n.length&&this.hasAttribute("multiword");return e.map(t=>({key:t,multiWord:s||n.includes(t)}))}connectedCallback(){let t=this.querySelector('input[type="text"], textarea');if(!(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement))return;let e=new TextExpander(this,t);l.set(this,e)}disconnectedCallback(){let t=l.get(this);t&&(t.destroy(),l.delete(this))}dismiss(){let t=l.get(this);t&&t.dismissMenu()}};window.customElements.get("text-expander")||(window.TextExpanderElement=TextExpanderElement,window.customElements.define("text-expander",TextExpanderElement))}}]);
//# sourceMappingURL=vendors-node_modules_github_text-expander-element_dist_index_js-4bcc1a408aff.js.map