"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_code-mirror_CodeMirror_tsx-_699b1"],{67044:(e,r,t)=>{t.d(r,{DV:()=>n,D_:()=>o.D_,EL:()=>o.EL,N9:()=>o.N9,Tz:()=>o.Tz,k0:()=>o.k0});var o=t(11793);let a=/(?:^|,)((?:[^,]|,(?=\+| |$))*(?:,(?=,))?)/g;function n(e){return Array.from(e.matchAll(a)).map(([,e])=>e)}},76134:(e,r,t)=>{t.d(r,{Ty:()=>n,YE:()=>l,Zf:()=>i});var o=t(46426),a=t(67044);let n=()=>{let e=document.querySelector("meta[name=keyboard-shortcuts-preference]");return!e||"all"===e.content},l=e=>/Enter|Arrow|Escape|Meta|Control|Mod|Esc/.test(e)||e.includes("Alt")&&e.includes("Shift"),c=new Set(["button","checkbox","color","file","hidden","image","radio","range","reset","submit"]),i=e=>{let r=(0,a.EL)(e),t=function(e){if(!(e instanceof HTMLElement))return!1;let r=e.nodeName.toLowerCase(),t=e.getAttribute("type")?.toLowerCase()??"text",o="true"===e.ariaReadOnly||"true"===e.getAttribute("aria-readonly")||null!==e.getAttribute("readonly");return("select"===r||"textarea"===r||"input"===r&&!c.has(t)||e.isContentEditable)&&!o}(e.target)&&(0,o.c)("no_character_key_shortcuts_in_inputs"),i=n()&&!t;return l(r)||i}},6867:(e,r,t)=>{t.r(r),t.d(r,{default:()=>Q});var o=t(85893),a=t(54850),n=t(67294),l=t(78120),c=t(76538),i=t(48252),s=t(45383),d=t(49892),u=t(59119),f=t(71632);let p={key:"Tab",run:({state:e,dispatch:r})=>e.selection.ranges.some(e=>!e.empty)?(0,s.at)({state:e,dispatch:r}):(r(e.update(e.replaceSelection(e.facet(u.c)),{scrollIntoView:!0,userEvent:"input"})),!0),shift:s.xi};var m=t(76134);let g=(0,m.Ty)()?[]:[{key:"Alt-g",run:()=>!0,preventDefault:!0}],b=[(0,s.m8)(),(0,u.nY)(),(0,a.Eu)(),(0,u.n$)(),(0,a.jH)({position:"absolute"}),(0,d.yC)({top:!0}),a.tk.editorAttributes.of({class:"js-codemirror-editor","data-testid":"codemirror-editor"}),[function(e,r,t){let o=t?r:[],n=new l.F6;return[n.of(o),a.$f.of([{key:e,run:function(e){let t=n.get(e.state)===r;return e.dispatch({effects:n.reconfigure(t?[]:r)}),!0}}])]}("Shift-Ctrl-m",a.$f.of([p]),!0),(0,f.L)(function(){let e=document.createElement("div"),r=e=>{let r=document.createElement("kbd");return r.textContent=e,r};return e.append("Use ",r("Control + Shift + m")," to toggle the ",r("tab")," key moving focus. Alternatively, use ",r("esc")," then ",r("tab")," to move to the next interactive element on the page."),e.className="cm-help-panel",e.id="focus-trap-help-panel",e}())],a.$f.of([...g,...s.wQ,...d.Lp,...s.f$])];var v=t(35524);let h={"&":{background:"var(--codeMirror-bgColor, var(--color-codemirror-bg))",color:"var(--codeMirror-fgColor, var(--color-codemirror-text))"},".cm-gutters":{background:"var(--codeMirror-gutters-bgColor, var(--color-codemirror-gutters-bg))",borderRightWidth:0},".cm-lineNumbers .cm-gutterElement":{color:"var(--codeMirror-lineNumber-fgColor, var(--color-codemirror-linenumber-text))",fontFamily:"var(--fontStack-monospace)",fontSize:"12px",lineHeight:"20px",padding:"0 16px 0 16px"},".cm-content":{caretColor:"var(--codeMirror-cursor-fgColor, var(--color-codemirror-cursor))",fontFamily:"var(--fontStack-monospace)",fontSize:"12px",background:"var(--codeMirror-lines-bgColor, var(--color-codemirror-lines-bg))",lineHeight:"20px",paddingTop:"8px"},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"var(--codeMirror-selection-bgColor, var(--color-codemirror-selection-bg, #d7d4f0))"},"&.cm-focused":{outline:"none"},"&.hide-help-until-focus":{"&.cm-focused .cm-panels-bottom":{display:"block"},"& .cm-panels-bottom":{display:"none"}},".cm-content ::-moz-selection":{backgroundColor:"var(--codeMirror-selection-bgColor, var(--color-codemirror-selection-bg, #d7d4f0))"},".cm-activeLine":{backgroundColor:"var(--codeMirror-activeline-bgColor, var(--color-codemirror-activeline-bg))"},".cm-line":{paddingLeft:"16px"},".cm-help-panel":{background:"var(--bgColor-muted, var(--color-canvas-subtle))",padding:"7px 10px",margin:0,fontSize:"13px",lineHeight:"16px",color:"var(--fgColor-muted, var(--color-fg-muted))"},".cm-panels-bottom":{borderTop:"var(--borderWidth-thin, 1px) solid var(--borderColor-default, var(--color-border-default))",background:"none"},".js-upload-markdown-image & .cm-panels-bottom":{bottom:"30px !important"},".cm-panel.cm-search":{background:"var(--bgColor-muted, var(--color-canvas-subtle))",padding:"8px",fontSize:"16px"},".cm-panel.cm-search > button":{borderRadius:"6px",padding:"4px 8px",background:"var(--codeMirror-bgColor, var(--color-codemirror-bg))",color:"var(--button-default-fgColor-rest, var(--color-btn-text))",border:"1px solid var(--button-default-borderColor-rest, var(--color-btn-border))",textTransform:"capitalize"},".cm-panel.cm-search > label":{color:"var(--fgColor-default, var(--color-fg-default))",textTransform:"capitalize",fontSize:"12px"},".cm-panel.cm-search > input":{borderRadius:"6px",padding:"4px 8px",background:"var(--bgColor-default, var(--color-canvas-default))",color:"var(--fgColor-default, var(--color-fg-default))",border:"1px solid var(--borderColor-default, var(--color-border-default))",fontSize:"12px"},'.cm-panel.cm-search > button[name="close"]':{padding:"4px"},".cm-panels-top":{borderBottom:"var(--borderWidth-thin, 1px) solid var(--color-border-default)",background:"none"},".cm-panel.cm-search input, .cm-panel.cm-search button, .cm-panel.cm-search label":{marginRight:"8px",marginBottom:"4px",marginTop:"4px",marginLeft:0},".cm-lintRange":{cursor:"help",backgroundImage:"none !important"},"&.custom-tooltips .cm-tooltip":{border:"none !important",backgroundColor:"transparent !important"},"&.custom-tooltips .cm-diagnostic":{padding:0,marginLeft:"0 !important",borderLeft:"none !important",whiteSpace:"unset"}},y=[{tag:[v.pJ.keyword],color:"var(--codeMirror-syntax-fgColor-keyword, var(--color-codemirror-syntax-keyword))"},{tag:[v.pJ.comment],color:"var(--codeMirror-syntax-fgColor-comment, var(--color-codemirror-syntax-comment))"},{tag:[v.pJ.bracket],color:"var(--codeMirror-matchingBracket-fgColor, var(--color-codemirror-matchingbracket-text))"},{tag:[v.pJ.string,v.pJ.url,v.pJ.regexp],color:"var(--codeMirror-syntax-fgColor-string, var(--color-codemirror-syntax-string))"},{tag:[v.pJ.constant(v.pJ.name),v.pJ.propertyName,v.pJ.attributeName],color:"var(--codeMirror-syntax-fgColor-constant, var(--color-codemirror-syntax-constant))"},{tag:[v.pJ.atom,v.pJ.number,v.pJ.bool],color:"var(--codeMirror-syntax-fgColor-constant, var(--color-codemirror-syntax-constant))"},{tag:[v.pJ.function(v.pJ.variableName)],color:"var(--codeMirror-syntax-fgColor-entity, var(--color-codemirror-syntax-entity))"},{tag:v.pJ.definition(v.pJ.variableName),color:"var(--codeMirror-syntax-fgColor-variable, var(--color-codemirror-syntax-variable))"},{tag:v.pJ.meta,color:"inherit"},{tag:v.pJ.heading,fontWeight:"bold",color:"inherit !important"},{tag:v.pJ.monospace,color:"var(--codeMirror-syntax-fgColor-comment, var(--color-codemirror-syntax-comment))"}],k=[{tag:v.pJ.link,textDecoration:"underline"},{tag:v.pJ.emphasis,fontStyle:"italic"},{tag:v.pJ.strong,fontWeight:"bold"},{tag:v.pJ.strikethrough,textDecoration:"line-through"}],x=[...y,...k],C=[...y,...k];function M(e=[]){let r=null!==document.querySelector('[data-color-mode="dark"]'),t=[...r?C:x,...e];return[a.tk.theme(h),(0,u.nF)(u.Qf.define(t),{fallback:!0})]}let w=e=>{let r=[l.yy.tabSize.of(e.indentUnit)];return e.indentWithTabs?r.push(u.c.of("	")):r.push(u.c.of(" ".repeat(e.indentUnit))),e.lineWrapping&&r.push(a.tk.lineWrapping),r};var J=t(25362);let E=(e,r)=>{let{state:t,placeholder:o,replacementText:a}=e.detail;"uploading"===t?(0,J.ZT)(r)?(0,J.t4)(r,o):(0,J.BH)(r,a):("uploaded"===t||"failed"===t)&&(0,J.nJ)(r,o,a)},S=(e,r)=>{let{left:t,top:o}=e.detail,a=r.posAtCoords({x:t,y:o});a&&r.dispatch({selection:{anchor:a,head:a}})},L=new WeakMap;function $(e,r){if((0,J.ZT)(e)){let t=(0,J.Mf)(e.state);(0,J.t4)(e,`${r}${t}${r}`)}else{let t=(0,J.Lp)(e);(0,J.BH)(e,r.repeat(2)),(0,J.KJ)(e,t.anchor+r.length)}return!0}function A(e,r){let t=(0,J.Lp)(e),o=e.state.doc.lineAt(t.from),a=(0,J.Mf)(e.state),n=RegExp(`^${"ol"===r?"\\d+\\.":r}\\s`);if(a){let t=a.endsWith("\n")?a.slice(0,-2):a,l=t.split("\n"),c=l.map((r,t)=>{let a=o.number+t;return{text:e.state.doc.line(a).text,lineNumber:a}}),i=c.every(e=>n.test(e.text));for(let t=0;t<c.length;t++){let o=c[t];if(i){let r=o.text.match(n);r&&(0,J.St)(e,o?.lineNumber,r[0])}else{let a=`${"ol"===r?`${t+1}.`:r} `;(0,J.Yr)(e,o?.lineNumber,a)}}}else{let a=o.text.match(n);if(a)(0,J.St)(e,o.number,a[0]);else{let a=`${"ol"===r?"1.":r} `;(0,J.Yr)(e,o.number,a),o.text||(0,J.KJ)(e,t.anchor+a.length)}}return!0}let D=[{key:"Mod-i",run:e=>$(e,"_"),preventDefault:!0},{key:"Mod-b",run:e=>$(e,"**"),preventDefault:!0},{key:"Mod-e",run:e=>$(e,"`"),preventDefault:!0},{key:"Mod-k",run:e=>{let r=(0,J.Mf)(e.state);if(r){let t=`[${r}](url)`;(0,J.t4)(e,t);let o=(0,J.sE)(e,t),a=o.value.from;(0,J.Z5)(e,a+r.length+3,a+r.length+6)}else{let r=(0,J.Lp)(e);(0,J.BH)(e,"[](url)"),(0,J.KJ)(e,r.anchor+1)}return!0},preventDefault:!0},{key:"Shift-Mod-.",run:e=>A(e,">"),preventDefault:!0},{key:"Shift-Mod-7",run:e=>A(e,"ol"),preventDefault:!0},{key:"Shift-Mod-8",run:e=>A(e,"-"),preventDefault:!0},{key:"Mod-v",run:e=>(L.set(e,!1),!1)},{key:"Shift-Mod-v",run:e=>(L.set(e,!0),!1)}];function T(e){let r=a.p.line({attributes:{dir:"auto"}}),t=new l.f_;for(let{from:o,to:a}of e.visibleRanges)for(let n=o;n<=a;){let o=e.state.doc.lineAt(n);t.add(o.from,o.from,r),n=o.to+1}return t.finish()}let N=a.lg.fromClass(class{update(e){(e.docChanged||e.viewportChanged)&&(this.decorations=T(e.view))}constructor(e){this.decorations=T(e)}},{decorations:e=>e.decorations}),R=[a.tk.domEventHandlers({keydown(e){(e.metaKey||e.ctrlKey)&&"k"===e.key&&e.stopPropagation()},paste(e,r){L.get(r)||function(e,r){let t=(0,J.Mf)(e.state),o=r.clipboardData;if(t&&o){let a=o.getData("text/plain");if(!/^https?:\/\//i.test(a))return;if(a){(0,J.t4)(e,`[${t}](${a})`);let o=(0,J.Lp)(e);(0,J.KJ)(e,o.anchor+a.length+4),r.preventDefault()}}}(r,e),L.set(r,!1)}}),a.$f.of(D),N];var _=t(34790),j=t(15205),H=t(60309);let W=(0,j.Z)(async function(){let e=new Request("/autocomplete/emojis_for_editor",{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),r=await fetch(e);if(200!==r.status)throw Error(`emoji request failed with a ${r.status}`);let t=await r.json(),o=Object.keys(t).map(e=>{let r=t[e];return{name:e,src:r[0],emoji:r[1]}});return o}),z=l.Py.define({map:({from:e,to:r,severity:t},o)=>({from:o.mapPos(e),to:o.mapPos(r),severity:t})}),B=l.QQ.define({create:()=>a.p.none,update(e,r){for(let t of(e=e.map(r.changes),r.effects))t.is(z)&&("error"===t.value.severity?e=e.update({add:[F.range(t.value.from,t.value.to)]}):"warning"===t.value.severity?e=e.update({add:[q.range(t.value.from,t.value.to)]}):"info"===t.value.severity&&(e=e.update({add:[O.range(t.value.from,t.value.to)]})));return e},provide:e=>a.tk.decorations.from(e)}),F=a.p.mark({class:"CodeMirror-lint-mark-error"}),q=a.p.mark({class:"CodeMirror-lint-mark-warning"}),O=a.p.mark({class:"CodeMirror-lint-mark-info"}),K=(e,r)=>{let{from:t,to:o,severity:a}=e.detail,n=(0,J.RL)(r,{line:t.lineNumber,ch:t.character}),l=(0,J.RL)(r,{line:o.lineNumber,ch:o.character});r.dispatch({effects:[z.of({from:n,to:l,severity:a})]})},P={ruby:[{tag:v.pJ.variableName,color:"var(--codeMirror-syntax-fgColor-variable, var(--color-codemirror-syntax-variable))"}]},Z=Object.keys(P),I=(0,n.forwardRef)((e,r)=>{let{value:t="",extensions:s=[],keyBindings:d=[],height:u="85vh",width:f="100%",focusNextRenderRef:p,...m}=e,g=(0,n.useRef)(null),v=function({extensions:e=[],fileName:r="",onChange:t,spacing:o,isHpc:s,enableFileUpload:d,parentRef:u,placeholder:f="Enter file contents here",ariaLabelledBy:p,value:m,width:g="",height:v="",minHeight:h="",hideHelpUntilFocus:y,onCreateEditor:k,onDestroyEditor:x}){let C=(0,n.useRef)(void 0),J=(0,n.useMemo)(()=>new l.F6,[]),L=(0,n.useMemo)(()=>new l.F6,[]),$=(0,n.useMemo)(()=>new l.F6,[]),A=(0,n.useCallback)(e=>{e.docChanged&&t(e.state.doc.toString()||"")},[t]),D=a.tk.updateListener.of(A),T=a.tk.theme({"&":{height:v,minHeight:h,width:g}}),N=(0,n.useMemo)(()=>[...b,D,T,(0,a.W$)(f),...w(o),[a.tk.domEventHandlers({"secret-detected:lint":K}),B],J.of([]),L.of([]),$.of([M()]),function(e){let r=a.lg.fromClass(class{constructor(r){r.scrollDOM.tabIndex=0,r.scrollDOM.setAttribute("role","region"),r.scrollDOM.setAttribute("aria-labelledby",e)}});return[r]}(p),a.tk.contentAttributes.of({"aria-labelledby":`${p} focus-trap-help-panel`}),a.tk.editorAttributes.of({class:y?"hide-help-until-focus":""})],[D,T,f,o,J,L,$,p,y]);return d&&(N.push((0,a.qr)()),N.push([a.tk.domEventHandlers({"upload:editor:change":E,"upload:editor:cursor":S})])),s&&N.push(a.tk.editorAttributes.of({"data-hpc":"true"})),N=N.concat(e),(0,n.useEffect)(()=>{let e=u.current;if(!e)return;let r=l.yy.create({doc:m,extensions:N}),t=new a.tk({state:r,parent:e});return k&&k(t),C.current=t,()=>{t.destroy(),x&&x(t)}},[]),(0,n.useEffect)(()=>{C.current&&C.current.dispatch({effects:l.Py.reconfigure.of(N)})},[N]),(0,n.useEffect)(()=>{if(C.current&&void 0!==m){let e=C.current.state.doc.toString()||"",r=m||"";r!==e&&C.current.dispatch({changes:{from:0,to:e.length,insert:r}})}},[m]),(0,n.useEffect)(()=>{let e=async()=>{let e=r.split(".").pop()||"",t=e?c.M.find(t=>t.extensions.includes(e)||t.filename&&t.filename.test(r)):void 0;if(t&&C.current){var o;let e=(o=t.name,Z.includes(o.toLowerCase())?P[o.toLowerCase()]:null);e&&C.current.dispatch({effects:$.reconfigure(M(e))}),"Markdown"===t.name?(C.current.dispatch({effects:J.reconfigure((0,i.markdown)({base:i.markdownLanguage}))}),C.current.dispatch({effects:l.Py.reconfigure.of([...R,...N])}),C.current.dispatch({effects:L.reconfigure([H.h,(0,_.ys)({override:[async e=>{let r=await W();return function(e,r=[]){let t=e.matchBefore(/:\w+/);if(!t||t&&t.from===t.to&&!e.explicit)return null;let o=r.filter(e=>-1!==e.name.indexOf(t.text.replace(":",""))),a=o.map(e=>({label:e.name,apply:e.emoji||`:${e.name}:`,type:e.src}));return{from:t.from,to:t.to,options:a,filter:!1}}(e,r)}],icons:!1,addToOptions:[{render:e=>{let r=document.createElement("img");return r.className="emoji emoji-result mr-2",r.height=20,r.width=20,r.alt=`:${e.label}:`,r.src=e.type,r.setAttribute("async",""),r},position:0}]}),l.Wl.highest(a.$f.of([{key:"Tab",run:_.dk}]))])})):C.current.dispatch({effects:J.reconfigure(await t.load())})}};C.current&&e()},[r,J,L,N,$]),C}({parentRef:g,value:t,height:u,width:f,extensions:[...s,a.$f.of(d)],...m});return(0,n.useImperativeHandle)(r,()=>({editor:g.current,view:v.current}),[g,v]),p?.current&&v&&(window.requestAnimationFrame(()=>{v.current&&!v.current.hasFocus&&v.current.focus()}),p.current=!1),(0,o.jsx)("div",{ref:g})});I.displayName="CodeMirror";let Q=I}}]);
//# sourceMappingURL=ui_packages_code-mirror_CodeMirror_tsx-_699b1-378bced50b94.js.map